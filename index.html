
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="theme-color" content="#000000">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  
  <title>Neon One: IQ Brain Puzzle 2025</title>
  
  <script>
    window.process = { env: { API_KEY: "" } };
    window.ADMOB_CONFIG = {
      APP_ID: "ca-app-pub-2785016732450485~8580314049",
      BANNER_ID: "ca-app-pub-2785016732450485/8223244910",
      REWARDED_ID: "ca-app-pub-2785016732450485/9049225512"
    };
  </script>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700;900&display=swap" rel="stylesheet">
  
  <style>
    body {
      font-family: 'Outfit', sans-serif;
      background-color: #000000;
      color: #ffffff;
      margin: 0;
      padding: 0;
      overflow: hidden;
      touch-action: none;
      -webkit-tap-highlight-color: transparent;
      user-select: none;
      height: 100dvh;
    }
    #root { height: 100%; width: 100%; display: flex; flex-direction: column; background: #000; }
    .bg-grid {
      background-image: radial-gradient(circle at 1px 1px, #ffffff08 1px, transparent 0);
      background-size: 30px 30px;
    }
    #initial-loader {
      position: fixed;
      inset: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: #000;
      z-index: 9999;
    }
    .loader-circle {
      width: 40px;
      height: 40px;
      border: 4px solid #1a1a1a;
      border-top: 4px solid #fff;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
  </style>

<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@19.0.0",
    "react-dom": "https://esm.sh/react-dom@19.0.0",
    "react-dom/client": "https://esm.sh/react-dom@19.0.0/client",
    "lucide-react": "https://esm.sh/lucide-react@0.460.0",
    "@google/genai": "https://esm.sh/@google/genai@1.3.0",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
</head>
<body class="bg-grid">
  <div id="initial-loader">
    <div class="loader-circle"></div>
    <p style="margin-top: 20px; font-size: 10px; color: #444; letter-spacing: 0.5em; font-weight: 900; text-transform: uppercase;">Neon One Loading</p>
  </div>
  <div id="root"></div>
  
  <script type="text/babel" data-presets="react,typescript">
    import React, { useState, useEffect, useRef, useCallback } from 'react';
    import ReactDOM from 'react-dom/client';
    import { 
      RotateCcw, Trophy, ArrowRight, Lightbulb, 
      Star, Loader2, Home, Volume2, VolumeX, 
      Play, FastForward, Settings, Share2, Award,
      ShieldCheck, Smartphone
    } from 'lucide-react';
    import { GoogleGenAI, Type } from "@google/genai";

    // --- GAME ENGINE LOGIC ---
    
    const getDifficultyConfig = (levelNum) => {
      if (levelNum <= 5) return { difficulty: 'EASY', nodeCount: 5 };
      if (levelNum <= 15) return { difficulty: 'MEDIUM', nodeCount: 7 };
      if (levelNum <= 30) return { difficulty: 'HARD', nodeCount: 10 };
      return { difficulty: 'ULTRA HARD', nodeCount: 14 };
    };

    const generateProceduralFallback = (levelNum) => {
      const { difficulty, nodeCount } = getDifficultyConfig(levelNum);
      const nodes = [];
      const center = 200;
      const spread = 120 + (Math.sin(levelNum) * 30);
      for(let i = 0; i < nodeCount - 1; i++) {
        const angle = (i * 2 * Math.PI) / (nodeCount - 1) + (levelNum * 0.1);
        nodes.push({ id: i, x: center + Math.cos(angle) * spread, y: center + Math.sin(angle) * spread });
      }
      nodes.push({ id: nodeCount - 1, x: center, y: center });
      const edges = [];
      for(let i = 0; i < nodeCount - 1; i++) {
        edges.push({ from: i, to: (i + 1) % (nodeCount - 1), used: false });
        edges.push({ from: i, to: nodeCount - 1, used: false });
      }
      return { id: levelNum, title: `Logic Pattern ${levelNum}`, difficulty, nodes, edges };
    };

    const createAudioSystem = () => {
      let ctx = null;
      const init = () => { if (!ctx) ctx = new (window.AudioContext || window.webkitAudioContext)(); };
      const playTone = (freq, type, duration, volume) => {
        try {
          init();
          if (!ctx) return;
          const osc = ctx.createOscillator(); const gain = ctx.createGain();
          osc.type = type; osc.frequency.setValueAtTime(freq, ctx.currentTime);
          gain.gain.setValueAtTime(volume, ctx.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + duration);
          osc.connect(gain); gain.connect(ctx.destination);
          osc.start(); osc.stop(ctx.currentTime + duration);
        } catch (e) {}
      };
      return {
        connect: () => playTone(1350, 'sine', 0.05, 0.03),
        error: () => playTone(160, 'sawtooth', 0.15, 0.04),
        win: () => { [523, 659, 783, 1046].forEach((f, i) => setTimeout(() => playTone(f, 'sine', 0.4, 0.04), i * 85)); },
        click: () => playTone(850, 'sine', 0.03, 0.02),
        reward: () => playTone(1600, 'triangle', 0.4, 0.05)
      };
    };

    // --- COMPONENTS ---

    const BannerAd = () => {
      const [isLoaded, setIsLoaded] = useState(false);
      useEffect(() => { setTimeout(() => setIsLoaded(true), 500); }, []);
      return (
        <div className="w-full h-[60px] bg-zinc-950/80 border border-white/5 flex items-center justify-between px-6 rounded-2xl overflow-hidden backdrop-blur-2xl mb-2">
          {!isLoaded ? <div className="w-full h-full flex items-center justify-center opacity-10 text-[8px] uppercase">Loading...</div> : (
            <><div className="flex items-center gap-3"><div className="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center"><Smartphone size={16} className="text-white" /></div><div className="flex flex-col"><span className="text-[10px] font-black uppercase text-white tracking-widest leading-none">AdMob Live</span><span className="text-[7px] text-zinc-600 font-bold uppercase">UNIT_8223244910</span></div></div><div className="text-[7px] bg-white text-black px-1.5 py-0.5 rounded-sm font-black uppercase">AD</div></>
          )}
        </div>
      );
    };

    const App = () => {
      const [gameState, setGameState] = useState('MENU');
      const [levelNumber, setLevelNumber] = useState(1);
      const [level, setLevel] = useState(null);
      const [currentNodeId, setCurrentNodeId] = useState(null);
      const [usedEdges, setUsedEdges] = useState(new Set());
      const [isDrawing, setIsDrawing] = useState(false);
      const [touchPos, setTouchPos] = useState({ x: 0, y: 0 });
      const [shake, setShake] = useState(false);
      const [muted, setMuted] = useState(false);
      const [adState, setAdState] = useState('IDLE');
      
      const audio = useRef(null);
      const container = useRef(null);
      const themeColor = ['#00F2FF', '#FF00FF', '#39FF14', '#FFD700', '#FF3131'][(levelNumber - 1) % 5];

      useEffect(() => {
        audio.current = createAudioSystem();
        setLevel(generateProceduralFallback(1));
        // Remove initial loader
        const loader = document.getElementById('initial-loader');
        if (loader) { loader.style.opacity = '0'; setTimeout(() => loader.style.display = 'none', 500); }
      }, []);

      const startLevel = (n) => {
        setLevel(generateProceduralFallback(n));
        setUsedEdges(new Set());
        setCurrentNodeId(null);
        setGameState('PLAYING');
      };

      const handlePointerMove = (e) => {
        if (!isDrawing || !level || currentNodeId === null) return;
        const rect = container.current.getBoundingClientRect();
        const x = ((e.clientX - rect.left) / rect.width) * 400;
        const y = ((e.clientY - rect.top) / rect.height) * 400;
        setTouchPos({ x, y });

        for (const node of level.nodes) {
          const d = Math.sqrt((node.x - x)**2 + (node.y - y)**2);
          if (d < 35 && node.id !== currentNodeId) {
            const k = [currentNodeId, node.id].sort().join('-');
            const exists = level.edges.find(ed => (ed.from === currentNodeId && ed.to === node.id) || (ed.from === node.id && ed.to === currentNodeId));
            if (exists && !usedEdges.has(k)) {
              setUsedEdges(new Set(usedEdges).add(k));
              setCurrentNodeId(node.id);
              if (!muted) audio.current.connect();
              if (usedEdges.size + 1 === level.edges.length) {
                setTimeout(() => { setGameState('WIN'); if(!muted) audio.current.win(); }, 100);
              }
              break;
            }
          }
        }
      };

      if (gameState === 'MENU') {
        return (
          <div className="flex-1 bg-black flex flex-col items-center justify-between p-10">
            <div className="pt-20 text-center">
              <h1 className="text-[100px] font-black italic tracking-tighter leading-[0.6] text-white">NEON<br/><span className="text-zinc-800">ONE</span></h1>
              <p className="mt-8 text-zinc-800 font-black uppercase tracking-[0.4em] text-[8px]">PRO ENGINE v2.5</p>
            </div>
            <button onClick={() => startLevel(levelNumber)} className="w-full max-w-[320px] bg-white text-black py-8 rounded-[3rem] font-black text-5xl active:scale-95 transition-all">PLAY</button>
            <BannerAd />
          </div>
        );
      }

      return (
        <div className={`flex-1 bg-black flex flex-col items-center justify-between pb-6 ${shake ? 'bg-rose-950/20' : ''}`}>
          <div className="w-full px-8 pt-8 flex justify-between items-center">
            <button onClick={() => setGameState('MENU')} className="p-3 bg-zinc-900 rounded-xl border border-white/5 text-white"><Home size={22}/></button>
            <div className="bg-zinc-900 px-6 py-2 rounded-full border border-white/5 text-white font-black">LVL {levelNumber}</div>
            <button onClick={() => { setUsedEdges(new Set()); setCurrentNodeId(null); }} className="p-3 bg-zinc-900 rounded-xl border border-white/5 text-white"><RotateCcw size={22}/></button>
          </div>

          <div ref={container} className="relative bg-[#040404] rounded-[4rem] border border-white/5" 
               style={{ width: 'min(90vw, 360px)', height: 'min(90vw, 360px)' }}
               onPointerMove={handlePointerMove} onPointerUp={() => { setIsDrawing(false); if(usedEdges.size < level?.edges.length && usedEdges.size > 0) { setShake(true); setTimeout(()=>setShake(false),200); setUsedEdges(new Set()); setCurrentNodeId(null); if(!muted) audio.current.error(); } }}>
            <svg width="100%" height="100%" viewBox="0 0 400 400" className="pointer-events-none">
              {level?.edges.map((e, i) => {
                const n1 = level.nodes.find(n => n.id === e.from); const n2 = level.nodes.find(n => n.id === e.to);
                const isUsed = usedEdges.has([e.from, e.to].sort().join('-'));
                return <line key={i} x1={n1.x} y1={n1.y} x2={n2.x} y2={n2.y} stroke={isUsed ? themeColor : "#111"} strokeWidth="20" strokeLinecap="round" style={{ filter: isUsed ? `drop-shadow(0 0 8px ${themeColor})` : 'none' }} />;
              })}
              {isDrawing && currentNodeId !== null && <line x1={level.nodes.find(n => n.id === currentNodeId).x} y1={level.nodes.find(n => n.id === currentNodeId).y} x2={touchPos.x} y2={touchPos.y} stroke={`${themeColor}44`} strokeWidth="10" strokeDasharray="10,10" />}
              {level?.nodes.map(n => <circle key={n.id} cx={n.x} cy={n.y} r="18" fill={currentNodeId === n.id ? "white" : "#050505"} stroke={currentNodeId === n.id ? themeColor : "#222"} strokeWidth="5" />)}
            </svg>
            <div className="absolute inset-0">
              {level?.nodes.map(n => <div key={n.id} className="absolute w-20 h-20 -translate-x-1/2 -translate-y-1/2" style={{ left: `${(n.x/400)*100}%`, top: `${(n.y/400)*100}%` }} onPointerDown={() => { setIsDrawing(true); setCurrentNodeId(n.id); if(!muted) audio.current.click(); }} />)}
            </div>
          </div>

          <div className="w-full px-8 max-w-[400px]"><BannerAd /></div>

          {gameState === 'WIN' && (
            <div className="fixed inset-0 bg-black/95 flex flex-col items-center justify-center p-10 z-[1000]">
              <Trophy size={100} className="text-yellow-400 mb-6 animate-bounce" />
              <h2 className="text-6xl font-black italic text-white mb-10">IQ BOOSTED</h2>
              <button onClick={() => { setLevelNumber(n => n + 1); startLevel(levelNumber + 1); }} className="w-full max-w-[300px] bg-white text-black py-6 rounded-full text-3xl font-black">NEXT LEVEL</button>
            </div>
          )}
        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
